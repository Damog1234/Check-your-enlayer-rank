<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenLayer Community Hub</title>
    <style>
        :root { --discord: #5865F2; --gold: #f1c40f; --bg: #0f172a; --card: #1e293b; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { background: var(--card); padding: 25px; border-radius: 15px; width: 100%; max-width: 500px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); text-align: center; border: 1px solid #334155; margin-bottom: 20px; }
        h1 { color: var(--discord); margin-bottom: 5px; }
        input { width: 80%; padding: 12px; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; margin-bottom: 10px; }
        button { background: var(--discord); color: white; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 85%; }
        
        /* Table Styles */
        .lb-card { background: var(--card); border-radius: 15px; width: 100%; max-width: 600px; overflow: hidden; border: 1px solid #334155; }
        table { width: 100%; border-collapse: collapse; text-align: left; font-size: 0.9rem; }
        th { background: #2d3748; padding: 12px; color: #94a3b8; text-transform: uppercase; font-size: 0.75rem; }
        td { padding: 12px; border-top: 1px solid #334155; }
        .rank-1 { color: var(--gold); font-weight: bold; }
        .user-cell { display: flex; align-items: center; gap: 10px; }
        .avatar { width: 30px; height: 30px; border-radius: 50%; background: #334155; }
        #status { font-size: 0.8rem; color: #64748b; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>üèÜ GenLayer Stats</h1>
    <p style="color: #94a3b8; margin-top: 0;">Search any user & see Top 10</p>
    <input type="text" id="username" placeholder="Discord Username...">
    <button onclick="searchUser()">Check Rank</button>
    <div id="status">Loading Leaderboard...</div>
</div>

<div class="lb-card">
    <table id="lbTable">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Member</th>
                <th>Level</th>
                <th>Messages</th>
            </tr>
        </thead>
        <tbody id="lbBody">
            </tbody>
    </table>
</div>

<script>
    const SERVER_ID = "1237055789441487021";
    let cachedPlayers = [];

    // Load Top 10 automatically on start
    window.onload = async () => {
        try {
            const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent('https://mee6.xyz/api/plugins/levels/leaderboard/' + SERVER_ID)}`);
            const rawData = await response.json();
            const data = JSON.parse(rawData.contents);
            cachedPlayers = data.players;
            
            displayTop10(cachedPlayers.slice(0, 10));
            document.getElementById('status').innerText = "‚úÖ Leaderboard Live";
        } catch (e) {
            document.getElementById('status').innerText = "‚ùå Error loading data.";
        }
    };

    function displayTop10(players) {
        const tbody = document.getElementById('lbBody');
        tbody.innerHTML = players.map((p, i) => `
            <tr class="${i === 0 ? 'rank-1' : ''}">
                <td>#${i + 1}</td>
                <td>
                    <div class="user-cell">
                        <img class="avatar" src="https://cdn.discordapp.com/avatars/${p.id}/${p.avatar}.png" onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png'">
                        ${p.username}
                    </div>
                </td>
                <td>Lvl ${p.level}</td>
                <td>${p.message_count}</td>
            </tr>
        `).join('');
    }

    function searchUser() {
        const query = document.getElementById('username').value.trim().toLowerCase();
        const player = cachedPlayers.find(p => p.username.toLowerCase() === query);
        
        if (player) {
            const rank = cachedPlayers.indexOf(player) + 1;
            alert(`Found: ${player.username}\nRank: #${rank}\nLevel: ${player.level}\nMessages: ${player.message_count}`);
        } else {
            alert("User not found in the current leaderboard cache.");
        }
    }
</script>

</body>
</html>
